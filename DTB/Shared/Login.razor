@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.WebUtilities
@using DTB.Data.App.User
@using DTB.Components.Account
@using System.Security.Claims
@inject UserManager<AppUser> UserManager
@inject IUserStore<AppUser> UserStore
@inject SignInManager<AppUser> SignInManager
@inject NavigationManager NavigationManager

<AuthorizeView>
    <NotAuthorized>
        <MMenu OffsetX Left OffsetY>
            <ActivatorContent Context="menuContext">
                <div class="text-center border-left-solid" style="width:88px;">
                    <MAvatar @attributes="menuContext.Attrs" Size=40>
                        <MImage Src="/img/avatar/2.svg"></MImage>
                    </MAvatar>
                </div>
            </ActivatorContent>
            <ChildContent>
                <MList Dense>
                    <MListItem Link Href="/Account/Login">
                        <MListItemIcon Class="mr-4">
                            <MIcon Size=20 Color="neutral-lighten-4">fa:fas fa-user-circle</MIcon>
                        </MListItemIcon>
                        <MListItemContent>
                            <MListItemTitle>
                                <span class="neutral-lighten-4--text">Login</span>
                            </MListItemTitle>
                        </MListItemContent>
                    </MListItem>
                </MList>
            </ChildContent>
        </MMenu>
    </NotAuthorized>
    <Authorized>
        <MMenu OffsetX Left OffsetY>
            <ActivatorContent Context="menuContext">
                <div class="text-center border-left-solid" style="width:88px;">
                    <MAvatar @attributes="menuContext.Attrs" Size=40>
                        <MImage Src="@context.User.FindFirst("Avatar")?.Value" />
                    </MAvatar>
                </div>
            </ActivatorContent>
            <ChildContent>
                <MList Dense>
                    <MListItem Link Href="/pages/authentication/login-v1">
                        <MListItemIcon Class="mr-4">
                            <MIcon Size=20 Color="neutral-lighten-4">fa:fas fa-user-edit</MIcon>
                        </MListItemIcon>
                        <MListItemContent>
                            <MListItemTitle>
                                <span class="neutral-lighten-4--text">Login v1</span>
                            </MListItemTitle>
                        </MListItemContent>
                    </MListItem>
                    <MListItem Link Href="/logout">
                        
                        <MListItemIcon Class="mr-4">
                            <MIcon Size=20 Color="neutral-lighten-4">fa:fas fa-sign-out-alt</MIcon>
                        </MListItemIcon>
                        <MListItemContent>
                            <MListItemTitle>
                                <span class="neutral-lighten-4--text">Logout</span>
                            </MListItemTitle>
                        </MListItemContent>
                    </MListItem>
                </MList>
            </ChildContent>
        </MMenu>
    </Authorized>
</AuthorizeView>
